# -*- coding: utf-8 -*-
"""Time_series_prediction.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1gGhrqbk70Sf6iNH6kUveUZeB6zVZY0Hj

# Time series prediction

## 1) Importing Necessary libraries
"""

import pickle
import pandas as pd
import matplotlib.pylab as plt
from datetime import date , datetime

"""## 2) Importing the model as a pickle file"""

filename = 'modelForRH.sav'
path = 'D:/sliit/iot/proj/iotbda-assignment-2023-2023_004_team/'
loaded_model = pickle.load(open(path + filename, 'rb')) # loading the model file from the storage

loaded_model

"""## 3) Past Predictions
## RH Prediction for 12 months before from the current date

"""

import datetime

# Get the current date
current_date = datetime.date.today()
# Get the past 12 months dates from current
past_end = current_date - pd.DateOffset(days=1)
past_start = current_date - pd.DateOffset(months=12)
# Get past prediction
past_prediction = loaded_model.predict(past_start, past_end)

past_prediction

plt.plot(past_prediction, label='past forecast')
plt.title('Relative Humidity ARIMA predictions')
plt.legend()

#save csv file of predictions
past_df = pd.DataFrame(past_prediction).reset_index()
past_df.columns = ['Date', 'Relative Humidity']
past_df.to_csv("D:/sliit/iot/proj/iotbda-assignment-2023-2023_004_team/dataset/past.csv",index=False)

"""## 4) Future Predictions
## RH Prediction for 12 months ahead from the current date
"""

# Get future 12 months dates from current
future_start = current_date + pd.DateOffset(days=1)
future_end = current_date + pd.DateOffset(months=12)
# Get future predictions
future_prediction = loaded_model.predict(future_start,future_end)

future_prediction

plt.plot(future_prediction,  label='future forecast')
plt.title('Relative Humidity ARIMA predictions')
plt.legend()

#save csv file of predictions
future_df = pd.DataFrame(future_prediction).reset_index()
future_df.columns = ['Date', 'Relative Humidity']
future_df.to_csv("D:/sliit/iot/proj/iotbda-assignment-2023-2023_004_team/dataset/future.csv",index=False)

future_df.head()

"""## prediction from 2019 to 12 months after current date"""

prediction = loaded_model.predict('01/01/2019', future_end)
prediction

plt.plot(prediction,  label='forecast')
plt.title('Relative Humidity ARIMA predictions')
plt.legend()